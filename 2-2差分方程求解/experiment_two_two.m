close all;
clear;
%调用conv函数计算卷积
x1n=[ones(1,8)];%产生信号x1(n)=R8(n)
h1n=[ones(1,10) zeros(1,10)];
h2n=[1,2.5,2.5,1,zeros(1,10)];
y21n=conv(h1n,x1n);
y22n=conv(h2n,x1n);
figure;
subplot(2,2,1);
stem(h1n);
title('（a）系统的单位脉冲响应h1(n)');
subplot(2,2,3);stem(y21n);
title('（b)h1（n）与R8(n)的卷积y21(n)');
subplot(2,2,2);stem(h2n);
title('(c)系统单位脉冲响应h2(n)');
subplot(2,2,4);stem(y22n);
title('(d)h2(n)与R8(n)的卷积y22(n)');

%调用filter解差分方程以及单位脉冲响应
A=[1,-0.9];B=[0.05,0.05];%系统差分方程向量B和A
X1n=[ones(1,8),zeros(1,25)];%产生信号X1(n)
X2n=ones(1,60);%产生信号X2(n)=u(n)
hn=impz(B,A,25);%求系统单位脉冲响应
figure;
subplot(3,1,1);stem(hn);
title('(a)系统单位脉冲响应h(n)');
y1n=filter(B,A,X1n);
subplot(3,1,2);stem(y1n);
title('(b)系统对R8(n)的响应y1(n)');
y2n=filter(B,A,X2n);
subplot(3,1,3);stem(y2n);
title('(c)系统对u(n)的响应y2(n)');
figure;
Y21n=conv(X1n,hn);
Y22n=conv(X2n,hn);
subplot(3,1,1);stem(hn);
title('(a)系统单位脉冲响应h(n)');
subplot(3,1,2);stem(Y21n(1:35));
title('(b)卷积y21(n)');
subplot(3,1,3);stem(Y22n(1:60));
title('(c)卷积y22(n)');
